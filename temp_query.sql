select  fl.boarding_date, fl.boarding_time, substr(fl.boarding_time,0,2) hours, fl.flight_no ,count( main_table.PAXLOG_ID) as passenger_count from im_flight_trans@DBL_IVFRT004 fl left join im_trans_arr_total@DBL_IVFRT004  main_table on fl.flight_no = main_table.pax_flight_no and fl.boarding_date = main_table.pax_boarding_date and fl.boarding_time = main_table.pax_boarding_time group by fl.flight_no, fl.boarding_date, fl.boarding_time, substr(fl.boarding_time,0,2) order by 1,2,3;